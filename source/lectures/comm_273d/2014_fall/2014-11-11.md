---
title: Dirty data, cleaned dirt cheap
date: 2014-11-11
description: "One of the most tedious but important parts of data analysis is just cleaning and organizing the data. Being a good \"data janitor\" lets you spend more time on the more fun parts of journalism."
---


__A special note about data cleaning:__ This week's lessons will probably drive you crazy. It's more important than ever to think: *Why am I doing this? What problem am I trying to solve? What is the kind of thing that I'm trying to understand?* 

Don't get too involved in seeing things as an arbitrary mix of tools and techniques to memorize, or you're going to want to quit civilized life to live in the mountains.




### Data "civilians"

From the New York Times, "[For Big-Data Scientists, ‘Janitor Work’ Is Key Hurdle to Insights](http://www.nytimes.com/2014/08/18/technology/for-big-data-scientists-hurdle-to-insights-is-janitor-work.html)", Aug. 17, 2014:

> The field known as “big data” offers a contemporary case study. The catchphrase stands for the modern abundance of digital data from many sources — the web, sensors, smartphones and corporate databases — that can be mined with clever software for discoveries and insights. Its promise is smarter, data-driven decision-making in every field. That is why data scientist is the economy’s hot new job.
>
> Yet far too much handcrafted work — what data scientists call “data wrangling,” “data munging” and “data janitor work” — is still required. Data scientists, according to interviews and expert estimates, spend from 50 percent to 80 percent of their time mired in this more mundane labor of collecting and preparing unruly digital data, before it can be explored for useful nuggets.
>
> “Data wrangling is a huge — and surprisingly so — part of the job,” said Monica Rogati, vice president for data science at Jawbone, whose sensor-filled wristband and software track activity, sleep and food consumption, and suggest dietary and health tips based on the numbers. “It’s something that is not appreciated by data civilians. At times, it feels like everything we do.”


### Cleaning names for "Dollars for Docs"

My biggest project at ProPublica was [Dollars for Docs](http://projects.propublica.org/docdollars/). A key component to our success was just being good at cleaning data.


- [Using Google Refine to Clean Messy Data](http://www.propublica.org/nerds/item/using-google-refine-for-data-cleaning) by me, while I was at ProPublica

Across all the different pharma companies who disclose financial relationships with doctors, a [doctor's name could be spelled in many different ways](http://www.propublica.org/article/dollars-for-docs-the-top-earners). So, how to find doctors which have [several relationships with different companies](http://www.propublica.org/article/dollars-for-docs-the-top-earners)?

![img](files/lectures/2014-11-11/gerald-sacks.png)


### Cleaning with OpenRefine

Using a [Pivot Table](https://docs.google.com/a/stanford.edu/spreadsheets/d/1EUKH_MatowsqLQHCZv7jC-7bUHMaKIb7eK66P6UWfXA/edit#gid=0) or GROUP BY in SQL won't quite work:

![img](files/lectures/2014-11-11/gsacks-pivot.png)

Note: This is a relatively simple example. Imagine a database of tens of thousands of names with all manner of variations in spelling, nevermind typos. Hand-editing with a spreadsheet won't cut it.

So we use [OpenRefine](http://www.openrefine.org) to __cluster the names__.

Two tutorials I've quickly put together to look at:

- How [to explore data with OpenRefine](/tutorials/open-refine/introduction-to-open-refine/)
- How [to cluster data with OpenRefine](/tutorials/open-refine/clustering)

Other resources:

- [The official screencasts from OpenRefine](https://github.com/OpenRefine/OpenRefine/wiki/Screencasts)
- [Cleaning Data with Refine](http://schoolofdata.org/handbook/recipes/cleaning-data-with-refine/) by the School of Data




#### Cleaning and categorization by OpenSecrets

[OpenSecrets.org, by Center for Responsive Politics](https://www.opensecrets.org/overview/sectors.php), purports to show how much money a political candidate gets from a particular industry:

![img](files/lectures/2014-11-11/open-secrets-table-by-industry.png)


But the data looks like this:

![img](files/lectures/2014-11-11/excel-of-iowa-contributions.png)


Here's how they explain their methodology:

[About the data in these industry profiles](https://www.opensecrets.org/industries/methodology.php)


> These profiles show the results of more than two decades of research by the Center for Responsive Politics on the funding of federal elections. While these are the most accurate numbers currently available, we constantly refine the data and will update the figures as often as possible. Totals for the current election cycle are typically updated every three to four weeks. Data from earlier years is updated as time and resources allow.

> All numbers attributed to a particular industry can be assumed to be conservative. Tens of millions of dollars of contributions in each election cycle are not classified by industry at all — either because the original data is incomplete or too vague to categorize, or because of limitations on the Center's ability to fully research the millions of individual contributions given over the years.

> **The Center is the only organization that invests in categorizing campaign contributions by industry in a way that includes individuals' contributions**, not just money from political action committees (PACs). Here's the logic behind our methodology, whether it's the oil/gasindustry, pharmaceutical industry or any of the hundreds of industries and interest groups we track on this site: Since corporations and other organizations are prohibited from making direct political contributions from their treasuries to political candidates, **you have to look at the contributions from people associated with the institution to gauge its political persuasion and how it might be trying to exert influence in Washington**.



### Working with FEC data

Let's get a taste of the mess that OpenSecrets tries to clean up.

The FEC provides [zipped CSV files by U.S. state of individual contributions](http://www.fec.gov/disclosurep/PDownload.do) to presidential candidates.

![img](files/lectures/2014-11-11/fec-presidential-election-map.png)


Here's the direct links to the Iowa individual contributions files:

- [2012 cycle](ftp://ftp.fec.gov/FEC/Presidential_Map/2012/P00000001/P00000001-IA.zip)
- [2008 cycle](ftp://ftp.fec.gov/FEC/Presidential_Map/2008/P00000001/P00000001-IA.zip)


__You can use this data for the homework__





#### Random notes

Fun story from the [Center for Investigative Reporting](https://beta.cironline.org/reports/california-water-officials-arent-following-own-call-for-conservation/):

> RIVERSIDE, Calif. – Mike Soubirous is a prodigious water user, pumping more than 1 million gallons per year at his lushly landscaped home on a hot, windy Southern California hilltop.

> Soubirous also is a member of the Riverside City Council, which in July voted unanimously to impose tough new water conservation rules in this desert city of 317,000.

> Last month at Riverside Councilman Mike Soubirous’ home, sprinklers were seen running seven nights in a row.
Credit: Stuart Palley for CIR
Yet as California’s drought worsened from 2012 to 2013, he consumed enough water to supply eight California households – more than any other top water official in the state, records show.

The source of the records:

> Water bills obtained via the state’s Public Records Act show that in 2013, nearly half of the officials who supervise the state’s biggest water agencies used more water than the typical California household.


##### On the subject of the midterm and LESO data

I [mentioned this in the answers](/pages/midterm-answers), but [Florida Today did a great investigation of how Brevard County uses military surplus to supplement its equipment](http://www.floridatoday.com/longform/news/local/2014/08/23/military-devices-used-in-warzones-now-in-brevard/14499225/):

>More than 27 years ago, in April 1987, William Cruse armed himself with an assault rifle and other weapons and stalked through two Palm Bay grocery stores, killing two police officers and four civilians. It is considered the worst mass-shooting in Brevard County history, and officials from two agencies interviewed by FLORIDA TODAY cited the incident in explaining the need for high-powered military weapons and armored trucks for protection.

> Put simply: The officers who responded that day were out-gunned.

> Palm Bay Police Chief Doug Muldoon said the officers were armed with revolvers and shotguns and one of the slain officers was killed while reloading.

> ...

> The Brevard County Sheriff's Aviation Unit, a five-chopper fleet that rescues stranded individuals and searches for suspects, is made up entirely of military surplus. One of the helicopters was shot down twice in Vietnam, Chief Pilot John Coppola said.

> The most recent addition is a UH-1H Huey chopper that arrived in May 2013 and will be used to help in firefighting and rescue operations. Coppola said it cost $2,000, but it needed some work. Replacing the machine's rotor blades and rotor shaft, as well as other maintenance, cost $12,000, Coppola said. To buy retail, he estimated it would have cost closer to $400,000.

##### Uber and FEC expenditures data

VICE Motherboard + data journalism - Reporter Kaleigh Rogers cites an analysis by [consulting firm Hamilton Place Strategies](http://www.hamiltonplacestrategies.com/news/uber-congress-new-private-driver): [Congress Is Taking More Uber Rides than a Drunken Undergrad with a Tax Rebate](http://motherboard.vice.com/read/congress-is-taking-more-uber-rides-than-a-drunken-undergrad-with-a-tax-rebate)

> HPS pulled data from Federal Election Committee and found members of Congress took about 2,800 Uber rides for less than $100 so far in 2014, compared to just 1,800 taxi rides. That’s a huge increase compared to 2012, when Uber was in its infancy: Congress only took about 100 Uber rides under $100 and about 2,800 low-cost taxi rides.

Chart via [Hamilton Place Strategies](http://www.hamiltonplacestrategies.com/news/uber-congress-new-private-driver):

![img](/files/lectures/2014-11-11/hamilton-1415723582945517.png)

> HPS pulled data from Federal Election Committee and found members of Congress took about 2,800 Uber rides for less than $100 so far in 2014, compared to just 1,800 taxi rides. That’s a huge increase compared to 2012, when Uber was in its infancy: Congress only took about 100 Uber rides under $100 and about 2,800 low-cost taxi rides.

> It’s a notable shift, considering Uber—along with Lyft, Airbnb and other so-called “peer-to-peer” businesses—are lobbying Congress and other levels of government to ease up regulations and allow their business model to thrive. Meanwhile, groups that represent more traditional businesses (like the New York Taxi Workers’ Alliance) are trying to get the government to put a leash on the competition.

Note the data-journalism-mentality behind this analysis:

- Look at the present data (2014 expenditures)
- Look at past data (2010 and 2012)
- Look at a specific slice of data relevant to the topic at hand (expenditures used for staffer transportation)
- Compare two competing sub-slices of data: Taxi vs Uber rides
- And, compare those sub-slices across all possible time frames to see a trend.





